<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Everbloom: Transcendence</title>
    <style>
        :root {
            --bg: #0a0a09; --panel: #161614; --accent: #d4a373; --text: #e0dcd3;
            --border: #3d3d34; --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* ì¢…ì¡± ì„ íƒ ë ˆì´ì–´ */
        #origin-screen { position: fixed; inset: 0; z-index: 1000; background: var(--bg); display: flex; flex-direction: column; padding: calc(var(--safe-top) + 20px) 20px; overflow-y: auto; }
        .race-card { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; }
        .race-card:active { border-color: var(--accent); background: #1f1f1c; }
        .race-card img { width: 50px; height: 50px; border-radius: 8px; border: 1px solid var(--accent); }

        /* ë©”ì¸ ìƒë‹¨ */
        header { padding: calc(var(--safe-top) + 10px) 20px 10px; background: var(--panel); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .visual-frame { width: 100%; height: 28vh; position: relative; background: #000; border-bottom: 2px solid var(--accent); }
        .visual-frame img.bg { width: 100%; height: 100%; object-fit: cover; opacity: 0.4; }
        .char-sprite { position: absolute; bottom: 0; left: 10%; height: 80%; z-index: 5; }

        /* íƒ­ ë° ì»¨í…ì¸  */
        .tab-bar { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; color: #666; font-weight: bold; }
        .tab-btn.active { color: var(--accent); border-bottom: 2px solid var(--accent); }

        .content { flex: 1; overflow-y: auto; padding: 20px; }
        .log-entry { margin-bottom: 10px; font-size: 15px; line-height: 1.6; border-left: 2px solid var(--border); padding-left: 12px; animation: fadeIn 0.3s; }
        
        /* ìŠ¤íƒ¯ ì—…ê·¸ë ˆì´ë“œ UI */
        .stat-row { display: flex; justify-content: space-between; align-items: center; background: #1c1c1a; padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 1px solid #333; }
        .up-btn { background: var(--accent); color: #000; border: none; padding: 5px 15px; border-radius: 5px; font-weight: bold; }
        .up-btn:disabled { background: #444; color: #888; }

        footer { padding: 15px 15px calc(var(--safe-bottom) + 20px); background: var(--panel); border-top: 1px solid var(--border); }
        .btn-stack { display: flex; flex-direction: column; gap: 8px; }
        .action-btn { background: #2a2a26; color: white; padding: 18px; border-radius: 12px; border: 1px solid #444; font-weight: bold; text-align: center; }
        .action-btn:active { background: var(--accent); color: #000; }

        #ending-screen { display: none; position: fixed; inset: 0; z-index: 2000; background: #000; padding: 40px 20px; flex-direction: column; justify-content: center; text-align: center; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="origin-screen">
        <h2 style="text-align:center; margin-bottom:20px; color:var(--accent);">ë‹¹ì‹ ì˜ ì¢…ì¡±ì„ ì •í•˜ì‹­ì‹œì˜¤</h2>
        <div id="race-list"></div>
    </div>

    <div id="ending-screen">
        <h1 id="end-title" style="color:var(--accent); font-size: 2.2rem; margin-bottom:20px;"></h1>
        <p id="end-desc" style="line-height:1.8; margin-bottom:40px; color:#ccc;"></p>
        <button class="action-btn" onclick="location.reload()">ìš´ëª…ì˜ ìˆ˜ë ˆë°”í€´ë¥¼ ë‹¤ì‹œ ëŒë¦¬ê¸°</button>
    </div>

    <div id="game-ui" style="display:none; flex-direction:column; height:100%;">
        <header>
            <div><span id="ui-race" style="color:var(--accent)"></span> Lv.<span id="ui-lv">1</span></div>
            <div>Day <span id="ui-day">1</span> / 500</div>
        </header>

        <div class="visual-frame">
            <img class="bg" id="ui-bg" src="https://images.unsplash.com/photo-1441974231531-c6227db76b6e?q=80&w=1000">
            <img class="char-sprite" id="ui-char" src="">
        </div>

        <div class="tab-bar">
            <button class="tab-btn active" id="tab-log" onclick="game.tab('log')">íƒí—˜</button>
            <button class="tab-btn" id="tab-stat" onclick="game.tab('stat')">ìºë¦­í„°</button>
        </div>

        <div id="pane-log" class="content"></div>
        <div id="pane-stat" class="content" style="display:none;">
            <div style="margin-bottom:15px; color:var(--accent); font-weight:bold;">ë‚¨ì€ í¬ì¸íŠ¸: <span id="ui-point">0</span></div>
            <div id="stat-list"></div>
            <div style="margin-top:20px; padding:10px; background:#222; border-radius:10px; font-size:13px; line-height:1.6;">
                <p>â¤ï¸ HP: <span id="st-hp"></span></p>
                <p>ğŸ’° GOLD: <span id="st-gold"></span></p>
                <p>âœ¨ EXP: <span id="st-exp"></span> / <span id="st-maxexp"></span></p>
            </div>
        </div>

        <footer>
            <div id="action-area" class="btn-stack"></div>
        </footer>
    </div>

<script>
const RACES = [
    { id:'Human', name:'ì¸ê°„', img:'https://i.ibb.co/vYm6p0v/hero-pixel.png', str:10, agi:10, int:10, luk:10, hp:100, desc:'ëª¨ë“  ëŠ¥ë ¥ì¹˜ê°€ ê³ ë¥´ê³  ì„±ì¥ì´ ë¹ ë¦…ë‹ˆë‹¤.' },
    { id:'Elf', name:'ì—˜í”„', img:'https://i.ibb.co/qY7v6p0/thief-pixel.png', str:5, agi:15, int:15, luk:5, hp:80, desc:'ë¯¼ì²©ê³¼ ì§€ë ¥ì´ ë†’ì§€ë§Œ ì²´ë ¥ì´ ë‚®ìŠµë‹ˆë‹¤.' },
    { id:'Orc', name:'ì˜¤í¬', img:'https://i.ibb.co/vXy6p0v/golem-pixel.png', str:18, agi:5, int:2, luk:5, hp:160, desc:'ê°•ë ¥í•œ ê·¼ë ¥ê³¼ ì²´ë ¥ì„ íƒ€ê³ ë‚¬ìŠµë‹ˆë‹¤.' },
    { id:'Halfling', name:'í•˜í”Œë§', img:'https://i.ibb.co/3W6f9fP/slime-pixel.png', str:4, agi:12, int:8, luk:16, hp:70, desc:'í–‰ìš´ì´ ë§¤ìš° ë†’ì•„ íŠ¹ë³„í•œ ì´ë²¤íŠ¸ë¥¼ ì˜ ì°¾ìŠµë‹ˆë‹¤.' },
    { id:'Beast', name:'ìˆ˜ì¸', img:'https://i.ibb.co/6P0f9X8/lizard-pixel.png', str:12, agi:14, int:4, luk:10, hp:110, desc:'ì „íˆ¬ì— íŠ¹í™”ëœ ì‹ ì²´ ëŠ¥ë ¥ì„ ë³´ìœ í•©ë‹ˆë‹¤.' },
    { id:'Angel', name:'ì²œì‚¬', img:'https://img.freepik.com/free-photo/mystical-ancient-ruins-forest-digital-art_23-2151121014.jpg', str:8, agi:8, int:12, luk:12, hp:100, desc:'ê³ ê²°í•œ ì¡´ì¬. ë†’ì€ ì§€ë ¥ê³¼ ëª…ì„±ì„ ê°€ì§‘ë‹ˆë‹¤.' },
    { id:'Demon', name:'ì•…ë§ˆ', img:'https://img.freepik.com/free-photo/fierce-warrior-confronting-monster-forest-digital-art_23-2151121050.jpg', str:15, agi:10, int:10, luk:5, hp:120, desc:'íŒŒê´´ì ì¸ í˜ì„ ì¶”êµ¬í•˜ëŠ” ì‹¬ì—°ì˜ ì¡´ì¬ì…ë‹ˆë‹¤.' }
];

const game = {
    p: { 
        race:null, day:1, lv:1, exp:0, maxExp:100, pt:0, hp:100, maxHp:100, gold:100, karma:0,
        str:0, agi:0, int:0, luk:0, started:false
    },

    init() {
        const list = document.getElementById('race-list');
        RACES.forEach(r => {
            const d = document.createElement('div');
            d.className = 'race-card';
            d.innerHTML = `<img src="${r.img}"><div><b>${r.name}</b><p style="font-size:11px; opacity:0.6;">${r.desc}</p></div>`;
            d.onclick = () => this.start(r);
            list.appendChild(d);
        });
    },

    start(race) {
        this.p.race = race;
        this.p.str = race.str; this.p.agi = race.agi; this.p.int = race.int; this.p.luk = race.luk;
        this.p.hp = race.hp; this.p.maxHp = race.hp;
        document.getElementById('origin-screen').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        document.getElementById('ui-race').innerText = race.name;
        document.getElementById('ui-char').src = race.img;
        this.log(`${race.name}ìœ¼ë¡œì„œ ìƒˆë¡œìš´ ì‚¶ì„ ì‹œì‘í•©ë‹ˆë‹¤. 500ì¼ì˜ ì‹œê°„ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤.`);
        this.renderActions();
    },

    tab(t) {
        document.getElementById('pane-log').style.display = t==='log'?'block':'none';
        document.getElementById('pane-stat').style.display = t==='stat'?'block':'none';
        document.getElementById('tab-log').className = t==='log'?'tab-btn active':'tab-btn';
        document.getElementById('tab-stat').className = t==='stat'?'tab-btn active':'tab-btn';
        if(t==='stat') this.renderStats();
    },

    renderStats() {
        const list = document.getElementById('stat-list');
        list.innerHTML = '';
        document.getElementById('ui-point').innerText = this.p.pt;
        const stats = [
            {id:'str', n:'ğŸ’ª ê·¼ë ¥ (ê³µê²©ë ¥)', v:this.p.str},
            {id:'agi', n:'ğŸƒ ë¯¼ì²© (íšŒí”¼/ì†ë„)', v:this.p.agi},
            {id:'int', n:'ğŸ§  ì§€ë ¥ (ë§ˆë²•/ì‚¬ê±´)', v:this.p.int},
            {id:'luk', n:'ğŸ€ í–‰ìš´ (ë³´ìƒ/ìš´)', v:this.p.luk}
        ];
        stats.forEach(s => {
            const row = document.createElement('div');
            row.className = 'stat-row';
            row.innerHTML = `<span>${s.n}: <b>${s.v}</b></span>
                <button class="up-btn" ${this.p.pt<=0?'disabled':''} onclick="game.upgrade('${s.id}')">+1</button>`;
            list.appendChild(row);
        });
        document.getElementById('st-hp').innerText = `${this.p.hp} / ${this.p.maxHp}`;
        document.getElementById('st-gold').innerText = this.p.gold;
        document.getElementById('st-exp').innerText = this.p.exp;
        document.getElementById('st-maxexp').innerText = this.p.maxExp;
    },

    upgrade(id) {
        if(this.p.pt > 0) {
            this.p[id]++; this.p.pt--;
            if(id === 'str') this.p.maxHp += 5;
            this.renderStats();
            this.checkStatEnding();
        }
    },

    renderActions() {
        const area = document.getElementById('action-area'); area.innerHTML = '';
        this.addBtn("ğŸŒ² ë¯¸ì§€ì˜ ìˆ² íƒí—˜ (Day +1)", () => this.explore());
        this.addBtn("â›º íœ´ì‹ê³¼ ëª…ìƒ", () => {
            this.p.hp = Math.min(this.p.maxHp, this.p.hp + 20);
            this.log("íœ´ì‹ì„ í†µí•´ ì²´ë ¥ì„ íšŒë³µí–ˆìŠµë‹ˆë‹¤.");
            this.nextDay();
        });
        this.updateUI();
    },

    explore() {
        this.p.exp += 25 + (this.p.int * 2);
        this.checkLvUp();
        
        const roll = Math.random();
        if(roll < 0.3) this.battle();
        else if(roll < 0.6) this.event();
        else this.log("ìˆ²ì€ í‰í™”ë¡œì› ìŠµë‹ˆë‹¤. ë³„ë‹¤ë¥¸ ì¼ ì—†ì´ í•˜ë£¨ê°€ ì§€ë‚¬ìŠµë‹ˆë‹¤.");
        
        this.nextDay();
    },

    battle() {
        this.log("<b style='color:red'>[ì „íˆ¬]</b> ìœ„í—˜í•œ ë§¹ìˆ˜ë¥¼ ë§Œë‚¬ìŠµë‹ˆë‹¤!");
        let dmg = Math.max(5, 20 - this.p.agi);
        this.p.hp -= dmg;
        this.p.gold += (10 + this.p.luk);
        this.log(`ì „íˆ¬ ìŠ¹ë¦¬! ì²´ë ¥ -${dmg}, ê³¨ë“œ +${10 + this.p.luk}.`);
    },

    event() {
        const evs = ["ê³ ëŒ€ ìœ ì  ë°œê²¬", "ìƒì¸ê³¼ì˜ ë§Œë‚¨", "ì •ë ¹ì˜ ìƒ˜í„°", "ë²„ë ¤ì§„ ìƒì"];
        const picked = evs[Math.floor(Math.random()*evs.length)];
        this.log(`<b style='color:cyan'>[ì‚¬ê±´]</b> ${picked}ì„(ë¥¼) ê²ªì—ˆìŠµë‹ˆë‹¤.`);
        this.p.gold += this.p.luk * 2;
    },

    checkLvUp() {
        while(this.p.exp >= this.p.maxExp) {
            this.p.lv++;
            this.p.exp -= this.p.maxExp;
            this.p.maxExp = Math.floor(this.p.maxExp * 1.3);
            this.p.pt += 5;
            this.log(`<b style='color:yellow'>[Level Up!]</b> ë ˆë²¨ ${this.p.lv} ë‹¬ì„±! ìŠ¤íƒ¯ í¬ì¸íŠ¸ 5ê°œë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.`);
        }
    },

    nextDay() {
        this.p.day++;
        if(this.p.day >= 500) this.end("ì‹œê°„ì˜ ë", "500ì¼ì˜ ê¸´ ì—¬ì •ì´ ëë‚¬ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ í‰ë²”í•œ ëª¨í—˜ê°€ë¡œ ê¸°ì–µë  ê²ƒì…ë‹ˆë‹¤.");
        this.updateUI();
    },

    checkStatEnding() {
        // ëŠ¥ë ¥ì¹˜ ê°€ì¤‘ ëŒíŒŒ ì—”ë”© (ìˆœìˆ˜ ìŠ¤íƒ¯ 100 ê¸°ì¤€)
        if(this.p.str >= 100) this.end("íˆ¬ì‹ (é¬ªç¥)ì˜ íƒ„ìƒ", "ë‹¹ì‹ ì˜ ìœ¡ì²´ëŠ” ì´ë¯¸ í•„ë©¸ìì˜ í•œê³„ë¥¼ ë„˜ì–´ì„°ìŠµë‹ˆë‹¤. ì „ì„¤ì ì¸ íˆ¬ì‹ ìœ¼ë¡œ ì¶”ì•™ë°›ìŠµë‹ˆë‹¤.");
        if(this.p.int >= 100) this.end("ì§„ë¦¬ì˜ íƒêµ¬ì", "ì„¸ìƒì˜ ëª¨ë“  ì„­ë¦¬ë¥¼ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ ìœ¡ì‹ ì„ ë²—ì–´ë˜ì§€ê³  ìˆœìˆ˜í•œ ì§€ì„±ì˜ ì¡´ì¬ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.");
        if(this.p.agi >= 100) this.end("ë°”ëŒì˜ ê·¸ë¦¼ì", "ë‹¹ì‹ ì˜ ì›€ì§ì„ì€ ë¹›ë³´ë‹¤ ë¹¨ë¼ì¡ŒìŠµë‹ˆë‹¤. ì´ì œ ëˆ„êµ¬ë„ ë‹¹ì‹ ì„ í¬ì°©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        if(this.p.luk >= 100) this.end("ìš´ëª…ì˜ ì§€ë°°ì", "ì„¸ìƒì˜ ëª¨ë“  í–‰ìš´ì´ ë‹¹ì‹ ì„ í–¥í•©ë‹ˆë‹¤. ë‹¹ì‹ ì´ ê±·ëŠ” ê¸¸ì€ ê³§ í™©ê¸ˆì˜ ê¸¸ì´ ë©ë‹ˆë‹¤.");
    },

    end(title, desc) {
        document.getElementById('ending-screen').style.display = 'flex';
        document.getElementById('end-title').innerText = title;
        document.getElementById('end-desc').innerText = desc;
    },

    updateUI() {
        document.getElementById('ui-day').innerText = this.p.day;
        document.getElementById('ui-lv').innerText = this.p.lv;
        if(this.p.hp <= 0) this.end("ì¢…ë§", "ë‹¹ì‹ ì˜ ì—¬ì •ì€ ì—¬ê¸°ì„œ ë©ˆì·„ìŠµë‹ˆë‹¤. ìˆ²ì˜ í™ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.");
    },

    log(m) {
        const pane = document.getElementById('pane-log');
        const div = document.createElement('div'); div.className = 'log-entry';
        div.innerHTML = `> ${m}`;
        pane.prepend(div);
    },

    addBtn(t, f) {
        const b = document.createElement('button'); b.className = 'action-btn'; b.innerText = t;
        b.onclick = (e) => { e.stopPropagation(); f(); };
        document.getElementById('action-area').appendChild(b);
    },

    btn(t, f) { this.addBtn(t, f); }
};

game.init();
</script>
</body>
</html>
