<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Everbloom: EryStart</title>
    <style>
        :root {
            --bg: #121210;
            --panel: #1e1e1a;
            --border: #3d3d34;
            --accent: #c08d4b;
            --text: #f7e7d6;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; }
        body { background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* ì‹œì‘ í™”ë©´ */
        #splash {
            position: fixed; inset: 0; z-index: 9999;
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                        url('https://img.freepik.com/free-photo/mystical-ancient-ruins-forest-digital-art_23-2151121014.jpg');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer;
        }

        /* ê²Œì„ ë©”ì¸ UI */
        #game-ui { display: none; flex-direction: column; height: 100%; padding-top: var(--safe-top); }

        /* ìƒë‹¨ ë¹„ì£¼ì–¼ */
        .visual-area { width: 100%; height: 35vh; border-bottom: 2px solid var(--accent); position: relative; background: #000; }
        .visual-area img { width: 100%; height: 100%; object-fit: cover; }

        /* íƒ­ ë©”ë‰´ */
        .tab-bar { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); }
        .tab-btn { flex: 1; padding: 20px; background: none; border: none; color: #888; font-weight: bold; font-size: 16px; }
        .tab-btn.active { color: var(--accent); border-bottom: 3px solid var(--accent); }

        /* ì»¨í…ì¸  ì˜ì—­ */
        .view-pane { flex: 1; overflow-y: auto; padding: 20px; display: none; }
        .view-pane.active { display: block; }

        /* ìºë¦­í„°/ì¸ë²¤í† ë¦¬ */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-card { background: var(--panel); padding: 15px; border: 1px solid var(--border); border-radius: 12px; font-size: 14px; }
        .item-card { 
            background: var(--panel); padding: 18px; border-radius: 12px; margin-bottom: 10px; 
            border: 1px solid #3d3d34; display: flex; justify-content: space-between; align-items: center; 
        }

        /* í•˜ë‹¨ ì»¨íŠ¸ë¡¤ (ë²„íŠ¼ í¬ê²Œ, ì–¸ë”ë°” ë°©ì§€) */
        footer { padding: 20px 20px calc(var(--safe-bottom) + 30px); background: var(--panel); border-top: 2px solid var(--border); }
        .choice-list { display: flex; flex-direction: column; gap: 12px; }
        .big-btn { 
            background: #3d3d34; color: #fff; border: 1px solid var(--border); 
            padding: 22px; border-radius: 15px; font-size: 1.1rem; font-weight: bold; text-align: left; 
        }
        .big-btn:active { background: var(--accent); color: #000; }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
    </style>
</head>
<body>

    <div id="splash" onclick="startGame()">
        <h1 style="font-size: 3rem; color: var(--accent); letter-spacing: 5px;">EVERBLOOM</h1>
        <p style="margin-top: 40vh; font-weight: bold; animation: blink 2s infinite;">TAP TO START</p>
    </div>

    <div id="game-ui">
        <header style="padding: 10px 20px; font-weight: bold; border-bottom: 1px solid var(--border);">
            <span>ğŸŒ¿ EryStart</span>
            <span id="turn-display" style="float: right; color: var(--accent);">Day 1</span>
        </header>

        <div class="visual-area">
            <img id="main-img" src="https://img.freepik.com/free-photo/mystical-ancient-ruins-forest-digital-art_23-2151121014.jpg">
        </div>

        <div class="tab-bar">
            <button id="tab-log-btn" class="tab-btn active" onclick="switchTab('log')">ì‹œë‚˜ë¦¬ì˜¤</button>
            <button id="tab-inv-btn" class="tab-btn" onclick="switchTab('inv')">ê°€ë°©/ëŠ¥ë ¥ì¹˜</button>
        </div>

        <div id="pane-log" class="view-pane active">
            <div id="log-container"></div>
        </div>

        <div id="pane-inv" class="view-pane">
            <div class="stat-grid">
                <div class="stat-card">âš”ï¸ ATK: <span id="p-atk">10</span></div>
                <div class="stat-card">ğŸ›¡ï¸ DEF: <span id="p-def">5</span></div>
                <div class="stat-card">â¤ï¸ HP: <span id="p-hp">100</span></div>
                <div class="stat-card">ğŸ’° GOLD: <span id="p-gold">50</span></div>
            </div>
            <div id="inventory-items"></div>
        </div>

        <footer>
            <div id="choice-area" class="choice-list"></div>
        </footer>
    </div>

<script>
    let player = { hp: 100, atk: 10, def: 5, gold: 50, inv: [], day: 1 };
    
    // ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•
    const IMGS = {
        ruin: "https://img.freepik.com/free-photo/mystical-ancient-ruins-forest-digital-art_23-2151121014.jpg",
        village: "https://img.freepik.com/free-photo/ancient-japanese-village-night-digital-art_23-2151025000.jpg",
        battle: "https://img.freepik.com/free-photo/fierce-warrior-confronting-monster-forest-digital-art_23-2151121050.jpg"
    };

    // ì¥ë¹„ 50ì¢… ìƒì„±
    const masterItems = Array.from({length: 50}, (_, i) => ({
        name: i % 2 === 0 ? ["ê°•ì²  ì¹´íƒ€ë‚˜", "ë…¸ë‹¤ì¹˜", "ëª…ê²€", "ì²­ë£¡ì–¸ì›”ë„", "ë…¹ìŠ¨ ê²€"][i%5] + ` (+${i})` : ["ê¸°ì‚¬ ê°‘ì˜·", "ê°€ì£½ í‰ê°‘", "ì°°ê°‘", "ë‘ì •ê°‘", "ë¡œë¦¬ì¹´"][i%5] + ` (+${i})`,
        atk: i % 2 === 0 ? 5 + i : 0,
        def: i % 2 === 0 ? 0 : 3 + i,
        price: 20 + (i * 5)
    }));

    function startGame() {
        document.getElementById('splash').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        addLog("ì—ë²„ë¸”ë£¸ì˜ ê²½ê³„ì— ì„œ ìˆìŠµë‹ˆë‹¤. ì „ì„¤ì— ë”°ë¥´ë©´ ì´ê³³ì—” ë™ì„œì–‘ì˜ ì˜ì›…ë“¤ì´ ë‚¨ê¸´ ë³´ë¬¼ì´ ê°€ë“í•˜ë‹¤ê³  í•©ë‹ˆë‹¤.");
        loadScene('start');
    }

    function switchTab(type) {
        document.querySelectorAll('.view-pane, .tab-btn').forEach(el => el.classList.remove('active'));
        if(type === 'log') {
            document.getElementById('pane-log').classList.add('active');
            document.getElementById('tab-log-btn').classList.add('active');
        } else {
            document.getElementById('pane-inv').classList.add('active');
            document.getElementById('tab-inv-btn').classList.add('active');
            renderInventory();
        }
    }

    function addLog(msg) {
        const logBox = document.getElementById('log-container');
        const p = document.createElement('div');
        p.style.marginBottom = "12px";
        p.style.lineHeight = "1.6";
        p.innerHTML = `<span style="color:var(--accent)">[Day ${player.day}]</span> ${msg}`;
        logBox.prepend(p);
    }

    function loadScene(type) {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        const img = document.getElementById('main-img');

        if(type === 'start') {
            img.src = IMGS.ruin;
            createChoice("ğŸ” ì£¼ë³€ ìœ ì ì„ íƒìƒ‰í•œë‹¤", () => handleEvent('explore'));
            createChoice("ğŸ¡ ë§ˆì„ ìƒì ê°€ë¡œ ì´ë™í•œë‹¤", () => loadScene('town'));
        } else if(type === 'town') {
            img.src = IMGS.village;
            addLog("ì•ˆê°œ ë§ˆì„ ìƒì ê°€ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì¥ë¹„ê°€ ì§„ì—´ë˜ì–´ ìˆìŠµë‹ˆë‹¤.");
            createChoice("ğŸ’° ëœë¤ ì¥ë¹„ êµ¬ë§¤ (30 Gold)", () => buyItem());
            createChoice("ğŸŒ² ë‹¤ì‹œ ìˆ²ìœ¼ë¡œ ëŒì•„ê°„ë‹¤", () => loadScene('start'));
        }
    }

    function createChoice(text, action) {
        const btn = document.createElement('button');
        btn.className = 'big-btn';
        btn.innerText = text;
        btn.onclick = () => {
            player.day++;
            document.getElementById('turn-display').innerText = `Day ${player.day}`;
            action();
        };
        document.getElementById('choice-area').appendChild(btn);
    }

    // 100ì¢… ì´ìƒì˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ ë¡œì§ (í•µì‹¬ ì—”ì§„)
    function handleEvent(category) {
        const roll = Math.floor(Math.random() * 100); 
        if(roll < 40) {
            const item = masterItems[Math.floor(Math.random() * masterItems.length)];
            player.inv.push({...item, equipped: false});
            addLog(`íƒìƒ‰ ì¤‘ ê³ ëŒ€ ìƒìì—ì„œ <b style="color:#fff">${item.name}</b>ì„(ë¥¼) ë°œê²¬í–ˆìŠµë‹ˆë‹¤!`);
        } else if(roll < 70) {
            addLog("íŠ¹ë³„í•œ ê²ƒì€ ì—†ì—ˆì§€ë§Œ, ìˆ²ì˜ ê¸°ìš´ì„ ë°›ì•„ ì •ì‹ ì´ ë§‘ì•„ì§‘ë‹ˆë‹¤.");
        } else {
            player.hp -= 5;
            addLog("ì´ë™ ì¤‘ì— ì‘ì€ í•¨ì •ì„ ë°Ÿì•˜ìŠµë‹ˆë‹¤. (HP -5)", "red");
        }
        loadScene('start');
        updateStats();
    }

    function buyItem() {
        if(player.gold >= 30) {
            player.gold -= 30;
            const item = masterItems[Math.floor(Math.random() * masterItems.length)];
            player.inv.push({...item, equipped: false});
            addLog(`[êµ¬ë§¤] ìƒì¸ì—ê²Œ ${item.name}ì„(ë¥¼) ìƒ€ìŠµë‹ˆë‹¤.`);
            updateStats();
        } else {
            addLog("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
        }
    }

    function renderInventory() {
        const box = document.getElementById('inventory-items');
        box.innerHTML = '';
        if(player.inv.length === 0) box.innerHTML = '<p style="opacity:0.5; text-align:center;">ê°€ë°©ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.</p>';
        
        player.inv.forEach((it, idx) => {
            const div = document.createElement('div');
            div.className = 'item-card';
            div.innerHTML = `
                <div>
                    <b>${it.name}</b><br>
                    <small style="color:var(--accent)">ATK +${it.atk} / DEF +${it.def}</small>
                </div>
                <button onclick="toggleEquip(${idx})" style="padding:10px; border-radius:8px; border:none; background:${it.equipped ? 'var(--accent)' : '#444'}; color:${it.equipped ? '#000' : '#fff'}; font-weight:bold;">
                    ${it.equipped ? 'í•´ì œ' : 'ì¥ì°©'}
                </button>
            `;
            box.appendChild(div);
        });
    }

    function toggleEquip(idx) {
        player.inv[idx].equipped = !player.inv[idx].equipped;
        updateStats();
        renderInventory();
    }

    function updateStats() {
        let bAtk = 0, bDef = 0;
        player.inv.forEach(i => { if(i.equipped) { bAtk += i.atk; bDef += i.def; } });
        document.getElementById('p-atk').innerText = 10 + bAtk;
        document.getElementById('p-def').innerText = 5 + bDef;
        document.getElementById('p-hp').innerText = player.hp;
        document.getElementById('p-gold').innerText = player.gold;
    }
</script>
</body>
</html>
