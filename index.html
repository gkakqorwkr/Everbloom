<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Everbloom: Eternal Saga</title>
    <style>
        :root {
            --bg: #0d0d0c; --panel: #1a1a17; --accent: #d4a373; --text: #f1eae0;
            --hp-color: #e63946; --gold-color: #ffb703; --border: #3d3d34;
            --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; }
        body { background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        /* Splash */
        #splash {
            position: fixed; inset: 0; z-index: 9999; background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), 
            url('https://images.unsplash.com/photo-1614728263952-84ea256f9679?q=80&w=1000');
            background-size: cover; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* Header & Visual */
        header { padding: calc(var(--safe-top) + 10px) 20px 10px; background: var(--panel); border-bottom: 2px solid var(--border); font-size: 13px; display: flex; justify-content: space-between; }
        .visual-box { width: 100%; height: 28vh; position: relative; border-bottom: 2px solid var(--accent); }
        .visual-box img { width: 100%; height: 100%; object-fit: cover; }
        .status-tags { position: absolute; bottom: 10px; left: 10px; display: flex; gap: 5px; }
        .tag { background: rgba(0,0,0,0.7); padding: 3px 8px; border-radius: 4px; font-size: 11px; border: 1px solid var(--accent); }

        /* Tabs */
        .tab-bar { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); }
        .tab-btn { flex: 1; padding: 15px; border: none; background: none; color: #777; font-weight: bold; font-size: 15px; }
        .tab-btn.active { color: var(--accent); border-bottom: 3px solid var(--accent); }

        /* Content */
        .main-view { flex: 1; overflow-y: auto; padding: 15px; }
        .pane { display: none; } .pane.active { display: block; }
        .log-entry { margin-bottom: 12px; line-height: 1.6; font-size: 15px; animation: fadeIn 0.3s forwards; }
        
        /* Stats & Inventory */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px; }
        .stat-item { background: var(--panel); padding: 10px; border-radius: 8px; border: 1px solid var(--border); }
        .item-card { background: #252520; padding: 12px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #444; }

        /* Controls */
        footer { padding: 15px 15px calc(var(--safe-bottom) + 20px); background: var(--panel); border-top: 2px solid var(--border); }
        .choice-list { display: flex; flex-direction: column; gap: 10px; }
        .btn { background: #33332d; color: #fff; padding: 18px; border-radius: 12px; border: 1px solid var(--border); font-weight: bold; text-align: left; font-size: 15px; }
        .btn:active { background: var(--accent); color: #000; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; } }
    </style>
</head>
<body onclick="startGame()">

    <div id="splash">
        <h1 style="font-size: 3rem; color: var(--accent); letter-spacing: 5px;">EVERBLOOM</h1>
        <p style="margin-top: 30vh; animation: pulse 2s infinite;">TAB TO START ADVENTURE</p>
    </div>

    <div id="game-ui" style="display:none; flex-direction:column; height:100%;">
        <header>
            <div><span id="p-job">Ï¥àÏã¨Ïûê</span> <span id="p-name">Ïó¨ÌñâÏûê</span></div>
            <div id="p-loc" style="color:var(--accent)">üìç Ïà≤Ïùò ÏûÖÍµ¨</div>
        </header>

        <div class="visual-box">
            <img id="main-img" src="https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=1000">
            <div class="status-tags" id="status-tags"></div>
        </div>

        <div class="tab-bar">
            <button class="tab-btn active" onclick="showTab('story', event)">Î°úÍ∑∏</button>
            <button class="tab-btn" onclick="showTab('inv', event)">Ï∫êÎ¶≠ÌÑ∞</button>
        </div>

        <div id="pane-story" class="main-view pane active">
            <div id="story-log"></div>
        </div>

        <div id="pane-inv" class="main-view pane">
            <div class="stat-grid">
                <div class="stat-item">‚ù§Ô∏è HP: <span id="hp-val">100</span></div>
                <div class="stat-item">üí∞ Gold: <span id="gold-val">100</span></div>
                <div class="stat-item">‚öîÔ∏è ATK: <span id="atk-val">10</span></div>
                <div class="stat-item">üõ°Ô∏è DEF: <span id="def-val">5</span></div>
                <div class="stat-item">‚ú® LV: <span id="lv-val">1</span></div>
                <div class="stat-item">üíä ÏÉÅÌÉú: <span id="cond-val">Ï†ïÏÉÅ</span></div>
            </div>
            <div id="inv-list"></div>
        </div>

        <footer>
            <div id="choice-area" class="choice-list"></div>
        </footer>
    </div>

<script>
    // --- Í≤åÏûÑ ÏãúÏä§ÌÖú Îç∞Ïù¥ÌÑ∞ ---
    const DB = {
        regions: {
            forest: { name: "üå≥ Ïö∏Ï∞ΩÌïú Ïà≤", img: "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?q=80&w=1000" },
            sea: { name: "üåä ÎÅùÏóÜÎäî Î∞îÎã§", img: "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1000" },
            mountain: { name: "‚õ∞Ô∏è ÌóòÏ§ÄÌïú Î∞îÏúÑÏÇ∞", img: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?q=80&w=1000" },
            snow: { name: "‚ùÑÔ∏è ÏñºÏñ¥Î∂ôÏùÄ ÏÑ§ÏÇ∞", img: "https://images.unsplash.com/photo-1491002052546-bf38f186af56?q=80&w=1000" },
            ruin: { name: "üèõÔ∏è Í≥†ÎåÄ Ïú†Ï†Å", img: "https://images.unsplash.com/photo-1518709268805-4e9042af9f23?q=80&w=1000" },
            cave: { name: "üï≥Ô∏è Ïñ¥ÎëêÏö¥ ÎèôÍµ¥", img: "https://images.unsplash.com/photo-1502657877623-f66bf489d236?q=80&w=1000" },
            town: { name: "üè° ÌèâÌôîÎ°úÏö¥ ÎßàÏùÑ", img: "https://images.unsplash.com/photo-1508913913451-9304481b2bb5?q=80&w=1000" }
        },
        jobs: {
            warrior: { name: "Í≤ÄÏÇ¨", atk: 15, def: 10 },
            mage: { name: "ÎßàÎ≤ïÏÇ¨", atk: 25, def: 2 },
            thief: { name: "ÎèÑÏ†Å", atk: 12, def: 5 }
        }
    };

    let p = { 
        hp: 100, gold: 100, atk: 10, def: 5, lv: 1, exp: 0, 
        job: "Ï¥àÏã¨Ïûê", loc: "forest", inv: [], cond: "Ï†ïÏÉÅ", isStarted: false 
    };

    // --- ÌïµÏã¨ Î°úÏßÅ ---
    function startGame() {
        if(p.isStarted) return;
        p.isStarted = true;
        document.getElementById('splash').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        log("ÏóêÎ≤ÑÎ∏îÎ£∏Ïùò Í±∞ÎåÄÌïú Ïó∞ÎåÄÍ∏∞Í∞Ä ÏãúÏûëÎê©ÎãàÎã§.");
        moveRegion('forest');
    }

    function showTab(id, e) {
        document.querySelectorAll('.pane, .tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById('pane-' + id).classList.add('active');
        e.target.classList.add('active');
        if(id === 'inv') renderInv();
    }

    function log(m) {
        const box = document.getElementById('story-log');
        const div = document.createElement('div');
        div.className = 'log-entry';
        div.innerHTML = `> ${m}`;
        box.prepend(div);
    }

    function moveRegion(key) {
        p.loc = key;
        const reg = DB.regions[key];
        document.getElementById('p-loc').innerText = `üìç ${reg.name}`;
        document.getElementById('main-img').src = reg.img;
        
        if(key === 'town') renderTown();
        else renderField();
    }

    // ÌïÑÎìú Ïù¥Î≤§Ìä∏ (100Ï¢Ö Ïù¥ÏÉÅÏùò Î¨¥ÏûëÏúÑ Ï°∞Ìï© Í∞ÄÎä•)
    function renderField() {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        createBtn("üîç Ï£ºÎ≥ÄÏùÑ ÏàòÏÉâÌïúÎã§", () => runEvent());
        createBtn("üß≠ Îã§Î•∏ ÏßÄÏó≠ÏúºÎ°ú Ïù¥Îèô", () => renderTravel());
        createBtn("üè° ÎßàÏùÑÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞", () => moveRegion('town'));
    }

    function runEvent() {
        const roll = Math.floor(Math.random() * 100);
        if(roll < 30) {
            log("‚öîÔ∏è Î™¨Ïä§ÌÑ∞Í∞Ä ÎÇòÌÉÄÎÇ¨ÏäµÎãàÎã§!");
            renderBattle();
        } else if(roll < 60) {
            log("üíé Î≤ÑÎ†§ÏßÑ ÏÉÅÏûêÎ•º Î∞úÍ≤¨ÌñàÏäµÎãàÎã§.");
            p.gold += 50; 
            updateStats();
        } else if(roll < 80) {
            log("‚ö†Ô∏è ÎèÖ ÎÑùÏø®Ïóê Í∏ÅÌòîÏäµÎãàÎã§! (ÏÉÅÌÉúÏù¥ÏÉÅ: Ï§ëÎèÖ)");
            p.cond = "Ï§ëÎèÖ";
            updateStats();
        } else {
            log("Î∞îÎûåÎßåÏù¥ Ïä§Ï≥ê ÏßÄÎÇòÍ∞ëÎãàÎã§.");
        }
    }

    // ÎßàÏùÑ ÏãúÏä§ÌÖú
    function renderTown() {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        createBtn("üè® Ïó¨Í¥Ä (ÌöåÎ≥µ/ÏóêÌîºÏÜåÎìú)", () => {
            p.hp = 100; p.cond = "Ï†ïÏÉÅ";
            log("Ïó¨Í¥ÄÏóêÏÑú Ìú¥ÏãùÌïòÎ©∞ Ïª®ÎîîÏÖòÏùÑ ÌöåÎ≥µÌñàÏäµÎãàÎã§.");
            updateStats();
        });
        createBtn("‚öíÔ∏è ÎåÄÏû•Í∞Ñ (Ïû•ÎπÑ Íµ¨Îß§)", () => {
            p.inv.push({name: "Í∞ïÏ≤† Í≤Ä", atk: 10, def: 0, eq: false});
            log("ÏÉàÎ°úÏö¥ Í≤ÄÏùÑ Ïû•Ï∞© Í∞ÄÎ∞©Ïóê ÎÑ£ÏóàÏäµÎãàÎã§.");
        });
        createBtn("üîÆ Ï†êÏà†Ï†ê (Ï†ÑÏßÅ)", () => renderJobChange());
        createBtn("üå≤ ÌïÑÎìúÎ°ú ÎÇòÍ∞ÄÍ∏∞", () => moveRegion('forest'));
    }

    function renderJobChange() {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        log("Ï†êÏà†Í∞ÄÍ∞Ä ÎãπÏã†Ïùò Ïö¥Î™ÖÏùÑ ÏùΩÏäµÎãàÎã§. Ïñ¥Îñ§ Í∏∏ÏùÑ Í∞ÄÏãúÍ≤†ÏäµÎãàÍπå?");
        Object.keys(DB.jobs).forEach(j => {
            createBtn(`‚ú® ${DB.jobs[j].name}Î°ú Ï†ÑÏßÅ`, () => {
                p.job = DB.jobs[j].name;
                p.atk += DB.jobs[j].atk;
                p.def += DB.jobs[j].def;
                log(`${p.job}(Ïúº)Î°ú Í∞ÅÏÑ±ÌñàÏäµÎãàÎã§!`);
                document.getElementById('p-job').innerText = p.job;
                updateStats();
                moveRegion('town');
            });
        });
    }

    function renderTravel() {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        Object.keys(DB.regions).filter(r => r !== 'town').forEach(r => {
            createBtn(`üö© ${DB.regions[r].name}`, () => moveRegion(r));
        });
    }

    function renderBattle() {
        const area = document.getElementById('choice-area');
        area.innerHTML = '';
        createBtn("‚öîÔ∏è ÎßûÏÑú Ïã∏Ïö¥Îã§", () => {
            if(p.atk > 20) { log("ÏïïÎèÑÏ†ÅÏù∏ ÌûòÏúºÎ°ú ÏäπÎ¶¨ÌñàÏäµÎãàÎã§!"); p.lv++; }
            else { log("ÏπòÏó¥Ìïú Ï†ÑÌà¨ ÎÅùÏóê Î∂ÄÏÉÅÏùÑ ÏûÖÏóàÏäµÎãàÎã§."); p.hp -= 20; }
            updateStats();
            renderField();
        });
        createBtn("üèÉ ÎèÑÎßùÏπúÎã§", () => { log("Î¨¥ÏÇ¨Ìûà ÎèÑÎßùÏ≥§ÏäµÎãàÎã§."); renderField(); });
    }

    function createBtn(t, fn) {
        const b = document.createElement('button');
        b.className = 'btn'; b.innerText = t;
        b.onclick = (e) => { e.stopPropagation(); fn(); };
        document.getElementById('choice-area').appendChild(b);
    }

    function renderInv() {
        const box = document.getElementById('inv-list');
        box.innerHTML = p.inv.length ? "" : "<p style='text-align:center; opacity:0.5'>Í∞ÄÎ∞©Ïù¥ ÎπÑÏóàÏäµÎãàÎã§.</p>";
        p.inv.forEach((it, i) => {
            const d = document.createElement('div');
            d.className = 'item-card';
            d.innerHTML = `<div>${it.name} (+${it.atk})</div><button onclick="toggleEq(${i})" style="padding:5px 10px; border-radius:5px; border:none; background:${it.eq?'var(--accent)':'#444'}">${it.eq?'Ìï¥Ï†ú':'Ïû•Ï∞©'}</button>`;
            box.appendChild(d);
        });
    }

    function toggleEq(i) {
        p.inv[i].eq = !p.inv[i].eq;
        updateStats(); renderInv();
    }

    function updateStats() {
        let ba = 0, bd = 0;
        p.inv.forEach(i => { if(i.eq) { ba += i.atk; bd += i.def; } });
        document.getElementById('hp-val').innerText = p.hp;
        document.getElementById('gold-val').innerText = p.gold;
        document.getElementById('atk-val').innerText = p.atk + ba;
        document.getElementById('def-val').innerText = p.def + bd;
        document.getElementById('lv-val').innerText = p.lv;
        document.getElementById('cond-val').innerText = p.cond;
        
        const tags = document.getElementById('status-tags');
        tags.innerHTML = p.cond !== "Ï†ïÏÉÅ" ? `<div class="tag" style="border-color:red">üíÄ ${p.cond}</div>` : "";
        
        if(p.hp <= 0) { alert("ÏÇ¨ÎßùÌïòÏÖ®ÏäµÎãàÎã§..."); location.reload(); }
    }
</script>
</body>
</html>
