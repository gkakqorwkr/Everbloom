<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Everbloom Chronicles</title>
    <style>
        :root {
            --bg: #0d0d0c; --panel: #1a1a17; --accent: #d4a373; --text: #e0dcd3;
            --border: #3d3d34; --btn-bg: #2a2a26; --safe-top: env(safe-area-inset-top);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Apple SD Gothic Neo', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* ì‹œì‘ í™”ë©´ */
        #start-screen { position: fixed; inset: 0; z-index: 5000; background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.8)), url('https://image.lexica.art/full_webp/cc2057ae-e069-450f-a2e6-a94b595bb919'); background-size: cover; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .start-title { font-size: 28px; font-weight: bold; color: var(--accent); margin-bottom: 40px; text-shadow: 0 2px 10px rgba(0,0,0,0.8); }
        .tap-msg { font-size: 16px; animation: blink 1.5s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }

        /* ë ˆì´ì•„ì›ƒ */
        header { padding: calc(var(--safe-top) + 10px) 20px 10px; background: var(--panel); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; font-size: 14px; z-index: 10; }
        .visual-area { width: 100%; height: 30vh; position: relative; background: #000; border-bottom: 2px solid var(--accent); overflow: hidden; flex-shrink: 0; }
        #char-img { position: absolute; bottom: -5%; left: 50%; transform: translateX(-50%); height: 105%; z-index: 5; object-fit: contain; pointer-events: none; }
        #bg-img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.4); transition: 0.5s; }

        .tab-bar { display: flex; background: var(--panel); border-bottom: 1px solid var(--border); flex-shrink: 0; }
        .tab-btn { flex: 1; padding: 12px; border: none; background: none; color: #777; font-weight: bold; font-size: 13px; }
        .tab-btn.active { color: var(--accent); border-bottom: 2px solid var(--accent); }

        /* ë©”ì¸ ì½˜í…ì¸  */
        .main-content { flex: 1; overflow-y: auto; padding: 15px; background: #111; }
        .log-line { margin-bottom: 6px; font-size: 14px; color: #ccc; border-left: 2px solid var(--border); padding-left: 10px; animation: slideIn 0.2s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-5px); } to { opacity: 1; transform: translateX(0); } }
        
        /* ì•„ì´í…œ/í« ìŠ¬ë¡¯ */
        .slot { background: #1c1c1a; padding: 12px; border-radius: 8px; margin-bottom: 8px; border: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        .slot.selected { border-color: var(--accent); background: #2a2a22; }
        .rarity-tag { font-size: 10px; padding: 2px 5px; border-radius: 4px; background: var(--accent); color: #000; font-weight: bold; margin-right: 5px; }

        /* í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ */
        footer { background: var(--panel); border-top: 1px solid var(--border); padding-bottom: env(safe-area-inset-bottom); max-height: 35vh; display: flex; flex-direction: column; }
        .action-container { overflow-y: auto; padding: 12px 15px; display: flex; flex-direction: column; gap: 8px; }
        .btn { background: var(--btn-bg); color: #fff; padding: 15px; border-radius: 10px; border: 1px solid #444; font-weight: bold; text-align: center; cursor: pointer; transition: 0.1s; }
        .btn:active { background: var(--accent); color: #000; transform: scale(0.98); }
        .btn:disabled { opacity: 0.3; pointer-events: none; }

        /* ì¢…ì¡± ì„ íƒ í™”ë©´ */
        #origin-screen { position: fixed; inset: 0; z-index: 4000; background: var(--bg); padding: 20px; overflow-y: auto; display: none; }
        .race-box { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; gap: 15px; transition: 0.2s; }
        .race-box:active { border-color: var(--accent); background: #222; }
    </style>
</head>
<body>

    <div id="start-screen" onclick="game.showOrigin()">
        <div class="start-title">Everbloom Chronicles</div>
        <div class="tap-msg">íƒ­ í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”</div>
    </div>

    <div id="origin-screen">
        <h2 style="text-align:center; color:var(--accent); margin-bottom:20px;">ì¶œì‹  ì¢…ì¡±ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤</h2>
        <div id="race-list"></div>
    </div>

    <div id="game-ui" style="display:none; flex-direction:column; height:100%;">
        <header>
            <div><span id="ui-race" style="color:var(--accent)"></span> Lv.<span id="ui-lv">1</span></div>
            <div id="ui-day">Day 1 / 500</div>
        </header>

        <div class="visual-area">
            <img id="bg-img" src="https://image.lexica.art/full_webp/51351532-3580-4963-8a9d-b8733b1e967a">
            <img id="char-img" src="">
        </div>

        <div class="tab-bar">
            <button id="tab-log" class="tab-btn active" onclick="game.tab('log')">íƒí—˜ ë¡œê·¸</button>
            <button id="tab-inv" class="tab-btn" onclick="game.tab('inv')">ì¸ë²¤í† ë¦¬/í«</button>
        </div>

        <div id="pane-log" class="main-content"></div>
        <div id="pane-inv" class="main-content" style="display:none;">
            <div id="stat-info" style="margin-bottom:15px; font-size:13px; color:var(--accent); line-height:1.6; background:#1c1c1a; padding:10px; border-radius:8px;"></div>
            <h4 style="margin-bottom:10px; font-size:14px; border-bottom:1px solid #333; padding-bottom:5px;">ë³´ìœ  ë¬¼í’ˆ (<span id="inv-count">0</span>/12)</h4>
            <div id="inv-list"></div>
        </div>

        <footer>
            <div id="action-list" class="action-container"></div>
        </footer>
    </div>

<script>
// ì¥ë¹„ ë° í« ë°ì´í„°ë² ì´ìŠ¤
const DB = {
    items: [
        { name: "ë…¹ìŠ¨ ë‹¨ê²€", type: "ì¥ë¹„", stat: "ATK+5", price: 40 },
        { name: "ê°€ì£½ ê°‘ì˜·", type: "ì¥ë¹„", stat: "DEF+3", price: 60 },
        { name: "ê°•ì²  ê²€", type: "ì¥ë¹„", stat: "ATK+12", price: 200 },
        { name: "ê¸°ì‚¬ì˜ ê°‘ì˜·", type: "ì¥ë¹„", stat: "DEF+10", price: 350 },
        { name: "í–‰ìš´ì˜ ê¸ˆí™”", type: "ì¥ë¹„", stat: "LUK+5", price: 500 }
    ],
    pets: [
        { name: "ì´ˆë³´ í–„ìŠ¤í„°", type: "í«", stat: "LUK+2", price: 100 },
        { name: "ì•„ê¸° ëŠ‘ëŒ€", type: "í«", stat: "ATK+4", price: 250 },
        { name: "í‘¸ë¥¸ ìš”ì •", type: "í«", stat: "INT+8", price: 600 }
    ]
};

const game = {
    p: { race:null, day:1, lv:1, exp:0, gold:300, hp:100, maxHp:100, str:10, agi:10, luk:5, inv:[] },
    mode: 'forest', selectedIdx: -1,

    showOrigin() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('origin-screen').style.display = 'block';
        const list = document.getElementById('race-list');
        // ìˆ˜ì¸, í•˜í”Œë§, ì²œì‚¬, ì•…ë§ˆ ì¢…ì¡± ë°ì´í„° ì¶”ê°€
        const races = [
            { id:'beast', name:'ìˆ˜ì¸', hp:130, str:14, agi:12, img:'https://image.lexica.art/full_webp/6e22f281-705b-4395-8884-60ff868b1ee4' },
            { id:'halfling', name:'í•˜í”Œë§', hp:90, str:8, agi:13, img:'https://image.lexica.art/full_webp/26253907-f377-497d-b14e-b830d1e39a58' },
            { id:'angel', name:'ì²œì‚¬', hp:110, str:11, agi:11, img:'https://image.lexica.art/full_webp/60183021-d779-4447-b50a-e373449c2505' }, // ì—˜í”„ ì†ŒìŠ¤ë¥¼ ì²œì‚¬ë¡œ í™œìš©
            { id:'demon', name:'ì•…ë§ˆ', hp:140, str:16, agi:9, img:'https://image.lexica.art/full_webp/01017b2b-6d65-4f35-9c88-12d770512803' }  // ì˜¤í¬ ì†ŒìŠ¤ë¥¼ ì•…ë§ˆë¡œ í™œìš©
        ];
        races.forEach(r => {
            const div = document.createElement('div'); div.className = 'race-box';
            div.innerHTML = `<img src="${r.img}" style="width:65px; height:65px; object-fit:cover; border-radius:10px; border:1px solid #444;"> 
                             <div><b>${r.name}</b><br><small style="color:#aaa;">ì²´ë ¥:${r.hp} ê·¼ë ¥:${r.str} ë¯¼ì²©:${r.agi}</small></div>`;
            div.onclick = () => { this.p.race = r; this.start(); };
            list.appendChild(div);
        });
    },

    start() {
        this.p.hp = this.p.race.hp; this.p.maxHp = this.p.race.hp;
        this.p.str = this.p.race.str; this.p.agi = this.p.race.agi;
        document.getElementById('origin-screen').style.display = 'none';
        document.getElementById('game-ui').style.display = 'flex';
        document.getElementById('ui-race').innerText = this.p.race.name;
        document.getElementById('char-img').src = this.p.race.img;
        this.renderActions();
        this.log(`${this.p.race.name}ì˜ í˜ˆí†µì´ ê¹¨ì–´ë‚¬ìŠµë‹ˆë‹¤. ëª¨í—˜ì„ ì‹œì‘í•©ë‹ˆë‹¤.`);
    },

    tab(type) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(`tab-${type}`).classList.add('active');
        document.getElementById('pane-log').style.display = type === 'log' ? 'block' : 'none';
        document.getElementById('pane-inv').style.display = type === 'inv' ? 'block' : 'none';
        if(type === 'inv') this.renderInv();
    },

    renderInv() {
        document.getElementById('stat-info').innerHTML = `â¤ï¸ HP: ${this.p.hp}/${this.p.maxHp} | âš”ï¸ STR: ${this.p.str}<br>ğŸ’° GOLD: ${this.p.gold}G | ğŸ€ LUK: ${this.p.luk}`;
        const list = document.getElementById('inv-list'); list.innerHTML = '';
        document.getElementById('inv-count').innerText = this.p.inv.length;
        this.p.inv.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = `slot ${this.selectedIdx === i ? 'selected' : ''}`;
            div.innerHTML = `<div><span class="rarity-tag">${item.type}</span><b>${item.name}</b><br><small style="color:#888;">${item.stat} | ê°€ì¹˜:${Math.floor(item.price*0.6)}G</small></div>`;
            div.onclick = () => { this.selectedIdx = (this.selectedIdx === i) ? -1 : i; this.renderInv(); };
            list.appendChild(div);
        });
    },

    renderActions() {
        const area = document.getElementById('action-list'); area.innerHTML = '';
        if(this.mode === 'forest') {
            this.addBtn("ğŸŒ² ê¹Šì€ ìˆ² íƒí—˜ (Day+1)", () => this.explore());
            this.addBtn("ğŸ•ï¸ ìº í•‘ (ì²´ë ¥ +30)", () => { this.p.hp = Math.min(this.p.maxHp, this.p.hp+30); this.p.day++; this.update(); this.log("ëª¨ë‹¥ë¶ˆ ê³ì—ì„œ íœ´ì‹ì„ ì·¨í–ˆìŠµë‹ˆë‹¤."); });
        } else if(this.mode === 'village') {
            this.addBtn("âš’ï¸ ëŒ€ì¥ê°„ (ì¥ë¹„ êµ¬ë§¤)", () => { this.mode = 'forge'; this.renderActions(); });
            this.addBtn("ğŸ¾ í« ìƒµ (ë™ë£Œ ì˜ì…)", () => { this.mode = 'petshop'; this.renderActions(); });
            this.addBtn("ğŸ›’ ì¡í™”ì  (íŒë§¤/ì •ë¹„)", () => { this.mode = 'shop'; this.renderActions(); });
            this.addBtn("ğŸŒ² ë§ˆì„ ë– ë‚˜ê¸°", () => { this.mode = 'forest'; this.renderActions(); });
        } else if(this.mode === 'forge' || this.mode === 'petshop') {
            const currentPool = this.mode === 'forge' ? DB.items : DB.pets;
            this.addBtn(this.mode === 'forge' ? "ğŸ“¦ ë¬´ì‘ìœ„ ì¥ë¹„ ìƒì (150G)" : "ğŸ¥š ë¬´ì‘ìœ„ í« ì•Œ (200G)", () => {
                const price = this.mode === 'forge' ? 150 : 200;
                if(this.p.gold >= price && this.p.inv.length < 12) {
                    this.p.gold -= price;
                    const res = currentPool[Math.floor(Math.random() * currentPool.length)];
                    this.p.inv.push({...res});
                    this.log(`${res.name}ì„(ë¥¼) ì†ì— ë„£ì—ˆìŠµë‹ˆë‹¤!`); this.update();
                } else if(this.p.inv.length >= 12) { this.log("ê°€ë°©ì´ ê°€ë“ ì°¼ìŠµë‹ˆë‹¤."); }
            });
            this.addBtn("â†©ï¸ ë§ˆì„ ê´‘ì¥", () => { this.mode = 'village'; this.renderActions(); });
        } else if(this.mode === 'shop') {
            this.addBtn("ğŸ’° ì„ íƒí•œ í•­ëª© íŒë§¤", () => {
                if(this.selectedIdx > -1) {
                    const price = Math.floor(this.p.inv[this.selectedIdx].price * 0.6);
                    this.p.gold += price;
                    this.log(`${this.p.inv[this.selectedIdx].name} íŒë§¤ ì™„ë£Œ. (+${price}G)`);
                    this.p.inv.splice(this.selectedIdx, 1);
                    this.selectedIdx = -1;
                    this.renderInv(); this.update();
                } else { this.log("ì¸ë²¤í† ë¦¬ì—ì„œ íŒë§¤í•  ë¬¼í’ˆì„ ì„ íƒí•˜ì„¸ìš”."); }
            });
            this.addBtn("â†©ï¸ ë§ˆì„ ê´‘ì¥", () => { this.mode = 'village'; this.renderActions(); });
        }
        area.scrollTop = 0;
    },

    explore() {
        this.p.day++;
        if(Math.random() < 0.25) {
            this.mode = 'village';
            this.log("ğŸ° ì•ˆê°œ ë„ˆë¨¸ë¡œ ë§ˆì„ì˜ ë¶ˆë¹›ì´ ë³´ì…ë‹ˆë‹¤.");
        } else {
            this.p.exp += 25;
            if(this.p.exp >= 100) { this.p.lv++; this.p.exp=0; this.log("âœ¨ í•œê³„ë¥¼ ëŒíŒŒí•˜ì—¬ ë ˆë²¨ì´ ì˜¬ëìŠµë‹ˆë‹¤!"); }
            this.log("ìˆ²ì„ ìˆ˜ìƒ‰í•˜ë©° ê²½í—˜ì„ ìŒ“ì•˜ìŠµë‹ˆë‹¤.");
        }
        this.update(); this.renderActions();
    },

    update() {
        document.getElementById('ui-lv').innerText = this.p.lv;
        document.getElementById('ui-day').innerText = `Day ${this.p.day} / 500`;
        const bg = document.getElementById('bg-img');
        if(this.mode === 'forest') bg.src = "https://image.lexica.art/full_webp/cc2057ae-e069-450f-a2e6-a94b595bb919";
        else bg.src = "https://image.lexica.art/full_webp/51351532-3580-4963-8a9d-b8733b1e967a";
    },

    log(m) {
        const p = document.getElementById('pane-log');
        const d = document.createElement('div'); d.className = 'log-line';
        d.innerText = `> ${m}`; p.prepend(d);
    },

    addBtn(t, f) {
        const b = document.createElement('div'); b.className = 'btn'; b.innerText = t; b.onclick = f;
        document.getElementById('action-list').appendChild(b);
    }
};

game.init = () => { /* ì´ˆê¸°í™” ë¡œì§ì´ í•„ìš”í•˜ë‹¤ë©´ ì—¬ê¸°ì— */ };
</script>
</body>
</html>
