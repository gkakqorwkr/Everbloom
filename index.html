<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Everbloom</title>
    <style>
        :root {
            /* í”¼ì½”í¬ ê·¸ë¦° & ì‹ ë¹„ë¡œìš´ ìˆ² í…Œë§ˆ */
            --bg-color: #0a1f1c;
            --panel-bg: rgba(20, 45, 40, 0.7);
            --accent-color: #2d6a4f;
            --text-color: #e9ecef;
            --glass-border: rgba(255, 255, 255, 0.1);
            --button-bg: #40916c;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #0a1f1c 0%, #1b4332 100%);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        header {
            padding: calc(var(--safe-top) + 20px) 20px 10px;
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        main {
            flex: 1;
            padding: 10px 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: calc(var(--safe-bottom) + 80px);
        }

        /* ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        .system-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .panel-title {
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.1s;
            touch-action: manipulation; /* iOS ì¤Œ ë°©ì§€ ë° í„°ì¹˜ ìµœì í™” */
        }

        button:active { transform: scale(0.96); opacity: 0.8; }

        /* ìºë¦­í„° ìŠ¤íŠœë””ì˜¤ ë¶„ë¦¬ êµ¬ì¡° */
        #charStudio {
            display: none; /* í•„ìš” ì‹œ JSë¡œ ì œì–´ */
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            z-index: 100;
            padding: var(--safe-top) 20px;
        }

        .input-field {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 12px;
            color: white;
            margin-bottom: 10px;
        }

        footer {
            position: fixed;
            bottom: 0; width: 100%;
            background: rgba(10, 31, 28, 0.9);
            padding-bottom: var(--safe-bottom);
            border-top: 1px solid var(--glass-border);
        }
    </style>
</head>
<body>

    <header>ğŸŒ¿ Everbloom</header>

    <main id="gameplay">
        <section class="system-panel">
            <div class="panel-title">ğŸ§™ ìºë¦­í„°</div>
            <div id="charStatus">ì—†ìŒ</div>
            <div class="btn-group">
                <button id="btnOpenStudio">ìºë¦­í„° ìƒì„±</button>
            </div>
        </section>

        <section class="system-panel">
            <div class="panel-title">ğŸ¾ í«</div>
            <div id="petInfo">seed-beast | ë‹¨ê³„ 1 | í˜¸ê° 0</div>
            <div class="btn-group">
                <button id="btnFeedPet">ë¨¹ì´ ì£¼ê¸°</button>
                <button id="btnBreedPet">êµë°°</button>
            </div>
        </section>

        <section class="system-panel">
            <div class="panel-title">ğŸ’• ê´€ê³„</div>
            <div id="relStatus">í˜¸ê°ë„ 0</div>
            <div class="btn-group">
                <button id="btnInteract">êµë¥˜</button>
            </div>
        </section>

        <section class="system-panel">
            <div class="panel-title">ğŸ‘¶ ìœ¡ì•„ (Princess Maker Style)</div>
            <div id="childStatus">ë‚˜ì´ 0 / ì„±ì¥ 0</div>
            <div class="btn-group">
                <button id="btnRaise">ì–‘ìœ¡</button>
            </div>
        </section>

        <section class="system-panel">
            <div class="panel-title">ğŸ‘¾ ëª¬ìŠ¤í„° ì¼ëŸ¬ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸</div>
            <textarea class="input-field" rows="3" readonly>Japanese fantasy monster illustration, forest, beast, high detail, no text</textarea>
            <button style="width:100%" id="btnGenMonster">í”„ë¡¬í”„íŠ¸ ìƒì„±</button>
        </section>
    </main>

    <div id="charStudio">
        <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>ìºë¦­í„° ìŠ¤íŠœë””ì˜¤</h2>
            <button id="btnCloseStudio">ë‹«ê¸°</button>
        </div>
        <div id="dotCanvasContainer" style="width:200px; height:200px; background:#000; margin: 0 auto 20px; border-radius:15px;">
            </div>
        <input type="text" class="input-field" placeholder="ì´ë¦„(ì„ íƒ)">
        <select class="input-field">
            <option>ì¢…ì¡± ì„ íƒ</option>
            <option>ì—˜í”„</option>
            <option>í‹°í”Œë§</option>
        </select>
        <button style="width:100%" id="btnSaveChar">ì¹´ë“œ ìƒì„± ë° ì €ì¥</button>
    </div>

    <script>
        // ìƒíƒœ ê´€ë¦¬
        const state = {
            char: JSON.parse(localStorage.getItem('eb_char')) || null,
            pet: { level: 1, exp: 0 },
            // ê¸°íƒ€ ì‹œìŠ¤í…œ ìƒíƒœë“¤...
        };

        // UI ìš”ì†Œ
        const studio = document.getElementById('charStudio');

        // pointerup ê¸°ë°˜ ì´ë²¤íŠ¸ ë°”ì¸ë”© (iOS ìµœì í™”)
        function bindEvent(id, handler) {
            const el = document.getElementById(id);
            if (el) {
                el.addEventListener('pointerup', (e) => {
                    e.preventDefault();
                    handler();
                });
            }
        }

        // ìŠ¤íŠœë””ì˜¤ ì—´ê¸°/ë‹«ê¸°
        bindEvent('btnOpenStudio', () => studio.style.display = 'block');
        bindEvent('btnCloseStudio', () => studio.style.display = 'none');

        // ì €ì¥ ë¡œì§
        bindEvent('btnSaveChar', () => {
            alert('ìºë¦­í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
            localStorage.setItem('eb_char', JSON.stringify({name: 'Hero'}));
            studio.style.display = 'none';
        });

        // í« ì–‘ìœ¡ ì˜ˆì‹œ
        bindEvent('btnFeedPet', () => {
            state.pet.exp += 10;
            document.getElementById('petInfo').innerText = `seed-beast | ë‹¨ê³„ 1 | í˜¸ê° ${state.pet.exp}`;
        });

        // ì´ˆê¸°í™” ì‹œ safe-area ë†’ì´ ë³´ì • ë“± ì²˜ë¦¬
        window.addEventListener('load', () => {
            console.log("Everbloom Engine Started");
        });
    </script>
</body>
</html>
