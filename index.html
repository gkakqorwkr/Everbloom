<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>EVERBLOOM: Layered</title>
    <style>
        :root {
            --bg: #2e2624;
            --panel: #4a3e3b;
            --border: #7a6a67;
            --text: #f7e7d6;
            --accent: #c08d4b;
            --btn: #6a5e5c;
            --safe-top: env(safe-area-inset-top);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'DotGothic16', sans-serif; }
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');

        body {
            background: var(--bg); color: var(--text);
            height: 100vh; display: flex; flex-direction: column;
            padding-top: var(--safe-top);
        }

        header {
            background: var(--panel); border-bottom: 2px solid var(--border);
            padding: 12px 20px; display: flex; justify-content: space-between; font-weight: bold;
        }

        /* ğŸ”¹ í•µì‹¬: ë¡œê·¸ì™€ ë„íŠ¸ë¥¼ ê°€ë¡œë¡œ ë°°ì¹˜ (ì´ë¯¸ì§€ 2ë²ˆ êµ¬ì¡°) */
        .game-main {
            display: grid;
            grid-template-columns: 1.2fr 1fr; /* ì™¼ìª½ ë¡œê·¸, ì˜¤ë¥¸ìª½ ë„íŠ¸ */
            gap: 10px; padding: 10px; flex: 1; min-height: 0;
        }

        .log-container {
            background: var(--panel); border: 2px solid var(--border);
            display: flex; flex-direction: column; overflow: hidden; border-radius: 8px;
        }

        .log-display {
            flex: 1; overflow-y: auto; padding: 12px; font-size: 14px; line-height: 1.6;
        }

        .scene-container {
            background: #000; border: 2px solid var(--border);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-radius: 8px; position: relative;
        }

        canvas {
            width: 100%; max-width: 180px; aspect-ratio: 1/1;
            image-rendering: pixelated;
        }

        /* ğŸ”¹ í•˜ë‹¨ ì»¨íŠ¸ë¡¤ */
        .footer {
            background: var(--panel); padding: 15px 10px calc(env(safe-area-inset-bottom) + 10px);
            border-top: 2px solid var(--border);
        }

        .controls {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;
        }

        button {
            background: var(--btn); border: 1px solid var(--border); color: var(--text);
            padding: 15px 5px; font-weight: bold; border-radius: 6px; font-size: 12px;
        }
        button:active { background: var(--accent); color: #000; }

        .event-txt { color: var(--accent); font-weight: bold; margin-bottom: 5px; }
        .system-txt { color: #888; font-size: 12px; }
    </style>
</head>
<body>

<header>
    <div>ğŸŒ¿ EVERBLOOM</div>
    <div id="turn">Turn 1</div>
</header>

<div class="game-main">
    <div class="log-container">
        <div class="log-display" id="log">
            <p class="event-txt">ëª¨í—˜ì˜ ì„œë§‰</p>
            <p>ì•ˆê°œ ë‚€ ê³ ëŒ€ ìœ ì ì˜ ì…êµ¬ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤. ìˆ²ì˜ ìˆ¨ê²°ì´ ëŠê»´ì§‘ë‹ˆë‹¤.</p>
        </div>
    </div>

    <div class="scene-container">
        <canvas id="scene" width="160" height="160"></canvas>
        <div style="position:absolute; bottom:5px; font-size:10px; color:var(--accent)">STATUS: ACTIVE</div>
    </div>
</div>

<div class="footer">
    <div class="controls">
        <button onclick="act('explore', 'ğŸ” ì£¼ë³€ì„ íƒìƒ‰í•˜ì—¬ ìœ ì ì˜ í”ì ì„ ì°¾ìŠµë‹ˆë‹¤.')">íƒí—˜</button>
        <button onclick="act('town', 'ğŸ¡ ì‘ì€ ë§ˆì„ì— ë„ì°©í•´ ì¥ë¹„ë¥¼ ì •ë¹„í•©ë‹ˆë‹¤.')">ë§ˆì„</button>
        <button onclick="act('battle', 'âš”ï¸ ë¤ë¶ˆ ì†ì—ì„œ êµ¶ì£¼ë¦° ìŠ¬ë¼ì„ì´ íŠ€ì–´ë‚˜ì˜µë‹ˆë‹¤!')">ì „íˆ¬</button>
        <button onclick="act('pet', 'ğŸ¾ í«ê³¼ ê°„ì‹ì„ ë‚˜ëˆ„ë©° ìœ ëŒ€ê°ì„ ìŒ“ìŠµë‹ˆë‹¤.')">í«</button>
    </div>
</div>

<script>
let turn = 1;
const canvas = document.getElementById("scene");
const ctx = canvas.getContext("2d");

const P = {
    o: "#1b1b1b",
    skin: "#d7b38c", skinS: "#b38b65",
    cloth: "#7c2f2f", clothS: "#551f1f",
    grass: "#2d4a3e", grassS: "#1b3329",
    slime: "#9bbfb2", slimeS: "#6e9f8e",
    hair: "#3a2a20", white: "#ffffff"
};

function px(x, y, w, h, col) {
    ctx.fillStyle = col;
    ctx.fillRect(x, y, w, h);
}

function drawBackground() {
    ctx.fillStyle = P.grass;
    ctx.fillRect(0, 0, 160, 160);
    // ë¬´ì‘ìœ„ í’€ì ë„íŠ¸
    for(let i=0; i<40; i++) {
        px(Math.random()*160, Math.random()*160, 2, 2, P.grassS);
    }
}

function drawHero(x, y) {
    // ë¨¸ë¦¬ & ë¨¸ë¦¬ì¹´ë½
    px(x+2, y-2, 12, 4, P.hair); // ë¨¸ë¦¬ì¹´ë½ ìœ„
    px(x+4, y, 8, 8, P.skin);   // ì–¼êµ´
    px(x+5, y+3, 2, 2, P.o);    // ëˆˆ1
    px(x+9, y+3, 2, 2, P.o);    // ëˆˆ2
    // ëª¸ì²´ (ê°‘ì˜· ëŠë‚Œ)
    px(x+2, y+8, 12, 12, P.cloth);
    px(x+4, y+10, 8, 2, P.clothS); // ì¥ì‹
    // ë‹¤ë¦¬
    px(x+3, y+20, 4, 6, P.hair);
    px(x+9, y+20, 4, 6, P.hair);
}

function drawSlime(x, y) {
    px(x, y+10, 20, 14, P.slime);
    px(x+2, y+18, 16, 6, P.slimeS);
    px(x+5, y+14, 3, 3, P.o);
    px(x+12, y+14, 3, 3, P.o);
    px(x+7, y+15, 1, 1, P.white); // ëˆˆê´‘
}

function render(type) {
    ctx.clearRect(0, 0, 160, 160);
    drawBackground();

    if(type === "battle") {
        drawHero(30, 70);
        drawSlime(100, 80);
    } else if(type === "pet") {
        drawHero(70, 70);
        px(100, 90, 10, 10, "#e9c46a"); // ì„ì‹œ í«
    } else {
        drawHero(70, 70);
    }
}

function act(type, msg) {
    turn++;
    document.getElementById("turn").innerText = "Turn " + turn;
    
    const logBox = document.getElementById("log");
    const p = document.createElement("p");
    p.innerHTML = `<span class="event-txt">[${type.toUpperCase()}]</span> ${msg}`;
    logBox.appendChild(p);
    logBox.scrollTop = logBox.scrollHeight;

    render(type);
}

// ì´ˆê¸° ì‹¤í–‰
render("explore");
</script>

</body>
</html>
